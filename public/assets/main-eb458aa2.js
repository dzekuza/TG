import{c as o,j as e,M as v,C as P,a as j,A as $,b as M,T,P as w,r as m,d as O,R as A}from"./index-c241957b.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=o("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=o("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=o("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=o("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=o("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=o("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=o("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function H({product:t,quantity:s,onQuantityChange:r}){const l=()=>{s>0&&r(t.id,s-1)},d=()=>{r(t.id,s+1)};return e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-20 h-20 mb-4 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden",children:e.jsx("span",{className:"text-3xl",children:t.emoji})}),e.jsx("h3",{className:"mb-1",children:t.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:t.description}),e.jsxs("div",{className:"text-2xl text-blue-600 mb-4",children:["$",t.price.toFixed(2)]}),e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("button",{onClick:l,className:"w-10 h-10 rounded-xl border-2 border-gray-200 flex items-center justify-center hover:bg-gray-50 transition-colors",disabled:s===0,children:e.jsx(z,{className:"w-4 h-4 text-gray-600"})}),e.jsx("span",{className:"w-8 text-center",children:s}),e.jsx("button",{onClick:d,className:"w-10 h-10 rounded-xl border-2 border-blue-200 bg-blue-50 flex items-center justify-center hover:bg-blue-100 transition-colors",children:e.jsx(I,{className:"w-4 h-4 text-blue-600"})})]}),s>0&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Total: $",(t.price*s).toFixed(2)]})]})})}function R({products:t,cart:s,onQuantityChange:r}){return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-center text-gray-800 mb-2",children:"ðŸ” Food Delivery"}),e.jsx("p",{className:"text-center text-gray-600 text-sm",children:"Choose your favorite items"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:t.map(l=>e.jsx(H,{product:l,quantity:s[l.id]||0,onQuantityChange:r},l.id))})]})}function Y({products:t,cart:s,onQuantityChange:r,onClearCart:l,onSubmitOrder:d}){const n=t.filter(a=>s[a.id]>0),b=n.reduce((a,x)=>a+x.price*s[x.id],0),h=Object.values(s).reduce((a,x)=>a+x,0);return n.length===0?e.jsxs("div",{className:"p-4 pb-20 flex flex-col items-center justify-center min-h-96",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ›’"}),e.jsx("h2",{className:"text-gray-800 mb-2",children:"Your cart is empty"}),e.jsx("p",{className:"text-gray-600 text-center text-sm",children:"Add some delicious items from our menu to get started!"})]}):e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-center text-gray-800 mb-2",children:"ðŸ§¾ Your Order"}),e.jsxs("p",{className:"text-center text-gray-600 text-sm",children:[h," item",h!==1?"s":""," in your cart"]})]}),e.jsx("div",{className:"space-y-4 mb-6",children:n.map(a=>e.jsx("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl bg-gray-100 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-2xl",children:a.emoji})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"mb-1",children:a.name}),e.jsxs("p",{className:"text-gray-600 text-sm mb-2",children:["$",a.price.toFixed(2)," each"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Qty: ",s[a.id]," Ã— $",a.price.toFixed(2)," = $",(a.price*s[a.id]).toFixed(2)]}),e.jsx("button",{onClick:()=>r(a.id,0),className:"text-red-500 hover:text-red-700 transition-colors",children:e.jsx(U,{className:"w-4 h-4"})})]})]})]})},a.id))}),e.jsxs("div",{className:"bg-blue-50 rounded-2xl p-4 mb-6 border border-blue-100",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-gray-700",children:"Subtotal:"}),e.jsxs("span",{className:"text-gray-900",children:["$",b.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-gray-700",children:"Delivery Fee:"}),e.jsx("span",{className:"text-gray-900",children:"$2.99"})]}),e.jsx("div",{className:"border-t border-blue-200 pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg text-gray-800",children:"Total:"}),e.jsxs("span",{className:"text-xl text-blue-600",children:["$",(b+2.99).toFixed(2)]})]})})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("button",{className:"w-full bg-gray-100 hover:bg-gray-200 transition-colors rounded-xl p-4 flex items-center gap-3",children:[e.jsx(v,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"text-gray-700",children:"Add delivery address"})]}),e.jsxs("button",{className:"w-full bg-gray-100 hover:bg-gray-200 transition-colors rounded-xl p-4 flex items-center gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"text-gray-700",children:"Add phone number"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:l,className:"flex-1 bg-gray-100 hover:bg-gray-200 transition-colors rounded-xl p-4 text-gray-700",children:"Clear Cart"}),e.jsx("button",{onClick:d,className:"flex-1 bg-green-500 hover:bg-green-600 transition-colors rounded-xl p-4 text-white",children:"Place Order"})]})]})}const B=t=>{switch(t){case"pending":return{icon:e.jsx(j,{className:"w-4 h-4"}),label:"Pending",bgColor:"bg-yellow-100",textColor:"text-yellow-700",borderColor:"border-yellow-200"};case"preparing":return{icon:e.jsx(w,{className:"w-4 h-4"}),label:"Preparing",bgColor:"bg-blue-100",textColor:"text-blue-700",borderColor:"border-blue-200"};case"on-the-way":case"arriving":return{icon:e.jsx(T,{className:"w-4 h-4"}),label:"On the way",bgColor:"bg-orange-100",textColor:"text-orange-700",borderColor:"border-orange-200"};case"delivered":case"arrived":return{icon:e.jsx(M,{className:"w-4 h-4"}),label:"Delivered",bgColor:"bg-green-100",textColor:"text-green-700",borderColor:"border-green-200"};case"cancelled":return{icon:e.jsx($,{className:"w-4 h-4"}),label:"Cancelled",bgColor:"bg-red-100",textColor:"text-red-700",borderColor:"border-red-200"};default:return{icon:e.jsx(j,{className:"w-4 h-4"}),label:t||"Unknown",bgColor:"bg-gray-100",textColor:"text-gray-700",borderColor:"border-gray-200"}}},V=t=>{const s=new Date(t),r=new Date,l=s.toDateString()===r.toDateString(),d=s.toDateString()===new Date(r.getTime()-24*60*60*1e3).toDateString();return l?`Today at ${s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}`:d?`Yesterday at ${s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}`:s.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})};function _({orders:t=[]}){return t.length===0?e.jsxs("div",{className:"p-4 pb-20 flex flex-col items-center justify-center min-h-96",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“‹"}),e.jsx("h2",{className:"text-gray-800 mb-2",children:"No order history"}),e.jsx("p",{className:"text-gray-600 text-center text-sm",children:"Your past orders will appear here once you place your first order!"})]}):e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-center text-gray-800 mb-2",children:"ðŸ“‹ Order History"}),e.jsx("p",{className:"text-center text-gray-600 text-sm",children:"Track your past orders and delivery status"})]}),e.jsx("div",{className:"space-y-4",children:t.map(s=>{const r=B(s.status);let l="";try{const d=typeof s.items=="string"?JSON.parse(s.items):s.items;l=Array.isArray(d)?d.map(n=>`${n.emoji?n.emoji+" ":""}${n.name||n.meal||""}${n.qty?" x"+n.qty:""}`).join(", "):s.items}catch{l=s.items}return e.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-gray-900 text-sm",children:["#",s.order_id]}),e.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-lg border ${r.bgColor} ${r.textColor} ${r.borderColor}`,children:[r.icon,e.jsx("span",{className:"text-xs",children:r.label})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-500 text-sm",children:[e.jsx(P,{className:"w-3 h-3"}),e.jsx("span",{children:V(s.created_at)})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-gray-900",children:["$",s.total||"0.00"]}),e.jsxs("div",{className:"text-gray-500 text-sm",children:[l.split(",").length," items"]})]})]}),e.jsx("div",{className:"space-y-2 mb-4",children:e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-lg",children:"ðŸ½ï¸"}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"text-sm text-gray-900",children:l})})]})}),s.eta&&e.jsxs("div",{className:"flex items-center gap-2 mb-3 p-3 bg-blue-50 rounded-lg border border-blue-100",children:[e.jsx(j,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{className:"text-sm text-blue-800",children:["Estimated arrival: ",e.jsxs("strong",{children:[s.eta," min"]})]})]}),s.comment&&e.jsxs("div",{className:"flex items-start gap-2 mb-3 p-3 bg-green-50 rounded-lg border border-green-100",children:[e.jsx(F,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-green-700 mb-1",children:"Comment:"}),e.jsx("div",{className:"text-sm text-green-800",children:s.comment})]})]}),s.location&&e.jsx("div",{className:"space-y-2 text-sm text-gray-600",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-3 h-3"}),e.jsx("span",{children:s.location})]})})]},s.order_id)})})]})}const p=[{id:1,name:"Classic Burger",price:12.99,emoji:"ðŸ”",description:"Juicy beef patty with lettuce, tomato, and cheese"},{id:2,name:"Pepperoni Pizza",price:18.99,emoji:"ðŸ•",description:"Classic pizza with pepperoni and mozzarella"},{id:3,name:"Caesar Salad",price:9.99,emoji:"ðŸ¥—",description:"Fresh romaine lettuce with Caesar dressing"},{id:4,name:"Chicken Tacos",price:14.99,emoji:"ðŸŒ®",description:"Grilled chicken with fresh vegetables and salsa"},{id:5,name:"French Fries",price:4.99,emoji:"ðŸŸ",description:"Crispy golden fries with sea salt"},{id:6,name:"Chocolate Cake",price:8.99,emoji:"ðŸ°",description:"Rich chocolate cake with cream filling"}];function J(){const[t,s]=m.useState("products"),[r,l]=m.useState({}),[d,n]=m.useState([]),[b,h]=m.useState(!1),[a,x]=m.useState(null);m.useEffect(()=>{var c;if(window.Telegram&&window.Telegram.WebApp){window.Telegram.WebApp.ready();const i=(c=window.Telegram.WebApp.initDataUnsafe)==null?void 0:c.user;i&&(x(i),u(i.id))}},[]);const u=async c=>{try{const g=await(await fetch(`/api/orders?user_id=${c}`)).json();g.orders&&n(g.orders)}catch(i){console.error("Error loading past orders:",i)}},y=(c,i)=>{l(g=>({...g,[c]:i}))},C=()=>{l({})},k=async()=>{if(!a){alert("Please log in to place an order");return}const c=p.filter(i=>r[i.id]>0);if(c.length===0){alert("Please add at least one item to your cart");return}h(!0);try{const i={meal:c.map(f=>`${f.name} x${r[f.id]}`).join(", "),user:a,location:{lat:0,lng:0},comment:""};(await(await fetch("/api/order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json()).success?(alert("Order placed successfully!"),l({}),u(a.id),s("history")):alert("Failed to place order. Please try again.")}catch(i){console.error("Error placing order:",i),alert("Error placing order. Please try again.")}finally{h(!1)}},N=Object.values(r).reduce((c,i)=>c+i,0),S=()=>{switch(t){case"products":return e.jsx(R,{products:p,cart:r,onQuantityChange:y});case"orders":return e.jsx(Y,{products:p,cart:r,onQuantityChange:y,onClearCart:C,onSubmitOrder:k});case"history":return e.jsx(_,{orders:d});default:return null}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"pb-16",children:S()}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-2 py-2",children:e.jsxs("div",{className:"flex",children:[e.jsxs("button",{onClick:()=>s("products"),className:`flex-1 flex flex-col items-center gap-1 py-2 px-3 rounded-xl transition-colors ${t==="products"?"bg-blue-50 text-blue-600":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(w,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"Products"})]}),e.jsxs("button",{onClick:()=>s("orders"),className:`flex-1 flex flex-col items-center gap-1 py-2 px-3 rounded-xl transition-colors relative ${t==="orders"?"bg-blue-50 text-blue-600":"text-gray-600 hover:text-gray-800"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"w-5 h-5"}),N>0&&e.jsx("div",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center",children:N})]}),e.jsx("span",{className:"text-xs",children:"Cart"})]}),e.jsxs("button",{onClick:()=>s("history"),className:`flex-1 flex flex-col items-center gap-1 py-2 px-3 rounded-xl transition-colors ${t==="history"?"bg-blue-50 text-blue-600":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(D,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"History"})]})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Placing your order..."})]})})]})}O.createRoot(document.getElementById("root")).render(e.jsx(A.StrictMode,{children:e.jsx(J,{})}));
