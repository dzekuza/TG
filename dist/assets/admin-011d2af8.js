import{c as C,r as m,j as e,a as k,M as S,C as f,A as O,b as _,T as $,P as M,d as A,R as P}from"./index-c392fb70.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=C("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),E=n=>{switch(n){case"pending":return{icon:e.jsx(f,{className:"w-4 h-4"}),label:"Pending",bgColor:"bg-yellow-100",textColor:"text-yellow-700",borderColor:"border-yellow-200"};case"preparing":return{icon:e.jsx(M,{className:"w-4 h-4"}),label:"Preparing",bgColor:"bg-blue-100",textColor:"text-blue-700",borderColor:"border-blue-200"};case"on-the-way":case"arriving":return{icon:e.jsx($,{className:"w-4 h-4"}),label:"On the way",bgColor:"bg-orange-100",textColor:"text-orange-700",borderColor:"border-orange-200"};case"delivered":case"arrived":return{icon:e.jsx(_,{className:"w-4 h-4"}),label:"Delivered",bgColor:"bg-green-100",textColor:"text-green-700",borderColor:"border-green-200"};case"cancelled":return{icon:e.jsx(O,{className:"w-4 h-4"}),label:"Cancelled",bgColor:"bg-red-100",textColor:"text-red-700",borderColor:"border-red-200"};default:return{icon:e.jsx(f,{className:"w-4 h-4"}),label:n||"Unknown",bgColor:"bg-gray-100",textColor:"text-gray-700",borderColor:"border-gray-200"}}},D=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});function L(){const[n,g]=m.useState([]),[j,u]=m.useState(!0),[h,b]=m.useState({}),[d,v]=m.useState("pending"),N=[{key:"pending",label:"Pending"},{key:"arriving",label:"On the way"},{key:"arrived",label:"Delivered"},{key:"cancelled",label:"Cancelled"}];m.useEffect(()=>{x()},[]);const x=async()=>{try{u(!0);const l=await(await fetch("/api/admin-orders")).json();l.orders&&g(l.orders)}catch(s){console.error("Error loading orders:",s)}finally{u(!1)}},p=async(s,l,o="",a="",r="")=>{b(t=>({...t,[s]:!0}));try{(await fetch("/api/admin-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order_id:s,status:l,comment:o,eta:a,driver_location:r})})).ok?await x():alert("Failed to update order status")}catch(t){console.error("Error updating order:",t),alert("Error updating order status")}finally{b(t=>({...t,[s]:!1}))}},w=async(s,l)=>{await p(s,l)};return j?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading orders..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Orders"}),e.jsx("p",{className:"text-gray-600",children:"Manage and update order status"})]}),e.jsxs("button",{onClick:x,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Refresh"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsx("div",{className:"overflow-x-auto mb-6",children:e.jsx("div",{className:"flex gap-2 min-w-max w-full",children:N.map(s=>e.jsx("button",{onClick:()=>v(s.key),className:`flex-1 px-4 py-2 rounded-lg font-medium border transition-colors whitespace-nowrap ${d===s.key?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-100"}`,style:{minWidth:120},children:s.label},s.key))})}),n.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“¦"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No orders yet"}),e.jsx("p",{className:"text-gray-600",children:"Orders will appear here when customers place them"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.filter(s=>d==="pending"?s.status==="pending"||s.status==="preparing":d==="arriving"?s.status==="arriving"||s.status==="on-the-way":d==="arrived"?s.status==="arrived"||s.status==="delivered":d==="cancelled"?s.status==="cancelled":!0).map(s=>{const l=E(s.status);let o="";try{const a=typeof s.items=="string"?JSON.parse(s.items):s.items;o=Array.isArray(a)?a.map(r=>{const t=r.name||r.meal||"",i=r.qty?` x${r.qty}`:"";return`${r.emoji?r.emoji+" ":""}${t}${t.includes("x")?"":i}`}).join(`
`):s.items}catch{o=s.items}return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1 rounded-full border mb-1 ${l.bgColor} ${l.textColor} ${l.borderColor}`,children:[l.icon,e.jsx("span",{className:"text-sm font-medium",children:l.label})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-500 text-sm",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:D(s.created_at)})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["User ID: ",s.user_id]})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Order Items:"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsx("p",{className:"text-gray-700",children:o})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Total:"}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-100",children:e.jsxs("span",{className:"text-blue-800 font-semibold",children:["â‚¬",s.total||"0.00"]})})]}),s.comment&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Comment:"}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-100",children:e.jsx("p",{className:"text-blue-800",children:s.comment})})]}),s.location&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Location:"}),(()=>{let a=s.location;try{typeof a=="string"&&(a=JSON.parse(a))}catch{}const r=(a==null?void 0:a.manual)||a;let t=null,i=null,y=!1;if(typeof r=="string"){let c=r.match(/@([\d.\-]+),([\d.\-]+)/);c||(c=r.match(/q=([\d.\-]+),([\d.\-]+)/)),c&&(t=c[1],i=c[2],y=!0)}return y&&t&&i?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("iframe",{title:"Map",width:"100%",height:"200",className:"rounded-lg border",src:`https://maps.google.com/maps?q=${t},${i}&z=15&output=embed`,allowFullScreen:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:`https://waze.com/ul?ll=${t},${i}&navigate=yes`,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-100 text-blue-700 px-3 py-2 rounded-xl text-xs font-semibold hover:bg-blue-200",children:"Go with Waze"}),e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"bg-gray-100 text-gray-700 px-3 py-2 rounded-xl text-xs font-semibold hover:bg-gray-200",children:"Open in Maps"})]})]}):e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:typeof a=="string"?a:JSON.stringify(a)})]})})()]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Update Status:"}),e.jsxs("select",{value:s.status,onChange:a=>w(s.order_id,a.target.value),disabled:h[s.order_id],className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"preparing",children:"Preparing"}),e.jsx("option",{value:"arriving",children:"On the way"}),e.jsx("option",{value:"arrived",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ETA (minutes):"}),e.jsx("input",{type:"text",placeholder:"e.g., 15",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onBlur:a=>p(s.order_id,s.status,s.comment,a.target.value,s.driver_location)})]})]}),h[s.order_id]&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-blue-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm",children:"Updating..."})]})]},s.order_id)})})]})]})}A.createRoot(document.getElementById("root")).render(e.jsx(P.StrictMode,{children:e.jsx(L,{})}));
