import{c as j,r as d,j as e,C as y,M as f,a as u,A as N,b as v,T as w,P as C,d as k,R as S}from"./index-9c8e805d.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=j("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),_=l=>{switch(l){case"pending":return{icon:e.jsx(u,{className:"w-4 h-4"}),label:"Pending",bgColor:"bg-yellow-100",textColor:"text-yellow-700",borderColor:"border-yellow-200"};case"preparing":return{icon:e.jsx(C,{className:"w-4 h-4"}),label:"Preparing",bgColor:"bg-blue-100",textColor:"text-blue-700",borderColor:"border-blue-200"};case"on-the-way":case"arriving":return{icon:e.jsx(w,{className:"w-4 h-4"}),label:"On the way",bgColor:"bg-orange-100",textColor:"text-orange-700",borderColor:"border-orange-200"};case"delivered":case"arrived":return{icon:e.jsx(v,{className:"w-4 h-4"}),label:"Delivered",bgColor:"bg-green-100",textColor:"text-green-700",borderColor:"border-green-200"};case"cancelled":return{icon:e.jsx(N,{className:"w-4 h-4"}),label:"Cancelled",bgColor:"bg-red-100",textColor:"text-red-700",borderColor:"border-red-200"};default:return{icon:e.jsx(u,{className:"w-4 h-4"}),label:l||"Unknown",bgColor:"bg-gray-100",textColor:"text-gray-700",borderColor:"border-gray-200"}}},A=l=>new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});function E(){const[l,c]=d.useState([]),[b,m]=d.useState(!0),[x,h]=d.useState({});d.useEffect(()=>{o()},[]);const o=async()=>{try{m(!0);const a=await(await fetch("/api/admin-orders")).json();a.orders&&c(a.orders)}catch(s){console.error("Error loading orders:",s)}finally{m(!1)}},g=async(s,a,i="",r="",t="")=>{h(n=>({...n,[s]:!0}));try{(await fetch("/api/admin-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order_id:s,status:a,comment:i,eta:r,driver_location:t})})).ok?await o():alert("Failed to update order status")}catch(n){console.error("Error updating order:",n),alert("Error updating order status")}finally{h(n=>({...n,[s]:!1}))}},p=async(s,a)=>{await g(s,a)};return b?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading orders..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Orders"}),e.jsx("p",{className:"text-gray-600",children:"Manage and update order status"})]}),e.jsxs("button",{onClick:o,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Refresh"]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“¦"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No orders yet"}),e.jsx("p",{className:"text-gray-600",children:"Orders will appear here when customers place them"})]}):e.jsx("div",{className:"grid gap-6",children:l.map(s=>{const a=_(s.status);let i="";try{const r=typeof s.items=="string"?JSON.parse(s.items):s.items;i=Array.isArray(r)?r.map(t=>`${t.emoji?t.emoji+" ":""}${t.name||t.meal||""}${t.qty?" x"+t.qty:""}`).join(", "):s.items}catch{i=s.items}return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("span",{className:"text-lg font-semibold text-gray-900",children:["#",s.order_id]}),e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1 rounded-full border ${a.bgColor} ${a.textColor} ${a.borderColor}`,children:[a.icon,e.jsx("span",{className:"text-sm font-medium",children:a.label})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-500 text-sm",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:A(s.created_at)})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["User ID: ",s.user_id]})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Order Items:"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsx("p",{className:"text-gray-700",children:i})})]}),s.comment&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Comment:"}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-100",children:e.jsx("p",{className:"text-blue-800",children:s.comment})})]}),s.location&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Location:"}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:s.location})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Update Status:"}),e.jsxs("select",{value:s.status,onChange:r=>p(s.order_id,r.target.value),disabled:x[s.order_id],className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"preparing",children:"Preparing"}),e.jsx("option",{value:"arriving",children:"On the way"}),e.jsx("option",{value:"arrived",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ETA (minutes):"}),e.jsx("input",{type:"text",placeholder:"e.g., 15",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onBlur:r=>g(s.order_id,s.status,s.comment,r.target.value,s.driver_location)})]})]}),x[s.order_id]&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-blue-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm",children:"Updating..."})]})]},s.order_id)})})})]})}k.createRoot(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(E,{})}));
